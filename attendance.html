<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Teacher Attendance Tracker ‚Äî BLMS Science Olympiad</title>

<style>
:root {
  --bg-light: linear-gradient(135deg, #e9f0ff, #f7f8ff);
  --bg-dark: linear-gradient(135deg, #0f1320, #1a1227);
  --text-light: #111318;
  --text-dark: #f4f6ff;
  --card-light: rgba(255,255,255,0.7);
  --card-dark: rgba(36,38,46,0.8);
  --border-light: rgba(0,0,0,0.1);
  --border-dark: rgba(255,255,255,0.15);
}
body {
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, Arial, sans-serif;
  background: var(--bg-light);
  color: var(--text-light);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 100vh;
  padding: 40px;
  transition: background 0.4s ease, color 0.4s ease;
}
[data-theme="dark"] body { background: var(--bg-dark); color: var(--text-dark); }

.container {
  background: var(--card-light);
  border: 1px solid var(--border-light);
  border-radius: 20px;
  backdrop-filter: blur(20px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.2);
  padding: 30px 40px;
  width: 95%;
  max-width: 700px;
}
[data-theme="dark"] .container {
  background: var(--card-dark);
  border: 1px solid var(--border-dark);
}
h1 {
  text-align: center;
  background: linear-gradient(90deg, #007aff, #9b7bff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 20px;
}
.controls {
  text-align: center;
  margin-bottom: 15px;
}
button {
  margin: 8px;
  padding: 10px 22px;
  border: none;
  border-radius: 999px;
  background: linear-gradient(90deg, #007aff, #9b7bff);
  color: white;
  font-weight: 600;
  cursor: pointer;
}
button:hover { opacity: 0.9; }

.student-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 10px;
  margin-top: 15px;
}
.student {
  display: flex;
  align-items: center;
  gap: 8px;
  background: rgba(255,255,255,0.5);
  padding: 8px 12px;
  border-radius: 10px;
  border: 1px solid var(--border-light);
}
[data-theme="dark"] .student {
  background: rgba(255,255,255,0.1);
  border: 1px solid var(--border-dark);
}
.success {
  text-align: center;
  color: limegreen;
  font-weight: 600;
  margin-top: 15px;
  opacity: 0;
  transition: opacity 0.4s ease;
}
.show { opacity: 1; }

.toggle {
  position: fixed;
  top: 16px;
  right: 20px;
  padding: 8px 16px;
  border-radius: 999px;
  border: 1px solid var(--border-light);
  background: var(--card-light);
  backdrop-filter: blur(20px);
  cursor: pointer;
}
[data-theme="dark"] .toggle { border: 1px solid var(--border-dark); background: var(--card-dark); color: white; }

/* === LOGIN OVERLAY === */
#loginOverlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(10px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}
.login-box {
  background: white;
  padding: 40px 50px;
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
}
.login-box h2 {
  margin-bottom: 20px;
  color: #007aff;
}
.login-box input {
  padding: 10px 14px;
  font-size: 1rem;
  border: 1px solid #ccc;
  border-radius: 10px;
  width: 100%;
  margin-bottom: 15px;
}
.login-box button {
  width: 100%;
  padding: 10px 16px;
  border-radius: 999px;
  background: linear-gradient(90deg,#007aff,#9b7bff);
  color: white;
  font-weight: 600;
  cursor: pointer;
}
#errorMsg { color: red; font-weight: 600; margin-top: 8px; }
</style>
</head>
<body>

<!-- === DARK MODE TOGGLE === -->
<button class="toggle" id="modeToggle">‚òÄÔ∏è Light / üåô Dark</button>

<!-- === LOGIN OVERLAY === -->
<div id="loginOverlay">
  <div class="login-box">
    <h2>Teacher Access</h2>
    <input type="password" id="passwordInput" placeholder="Enter password" />
    <button id="loginBtn">Login</button>
    <div id="errorMsg"></div>
  </div>
</div>

<!-- === ATTENDANCE FORM === -->
<div class="container" id="mainContainer" style="display:none;">
  <h1>BLMS Science Olympiad Attendance</h1>

  <div class="controls">
    <label><b>Date:</b> <input type="date" id="date" required /></label>
    <div>
      <button type="button" id="markPresent">Mark Present</button>
      <button type="button" id="markAbsent">Mark Absent</button>
      <button type="button" id="markExcused">Mark Excused</button>
      <button type="button" id="submitBtn">Submit</button>
    </div>
  </div>

  <div class="student-list" id="studentList"></div>

  <div class="success" id="successMsg">‚úÖ Attendance Recorded!</div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyEcerEeYrjg8ZVyFXEtmatQCuEF0Fg6739b9AK1Z6jzbhSLyq6dEO7foQAmpdSbukVDw/exec";
const TEACHER_PASSWORD = "blms2025"; // üîí Change this password

// === LOGIN HANDLER ===
document.getElementById("loginBtn").addEventListener("click", () => {
  const entered = document.getElementById("passwordInput").value.trim();
  if (entered === TEACHER_PASSWORD) {
    document.getElementById("loginOverlay").style.display = "none";
    document.getElementById("mainContainer").style.display = "block";
  } else {
    document.getElementById("errorMsg").textContent = "Incorrect password!";
  }
});

// === DARK MODE ===
document.getElementById("modeToggle").addEventListener("click", () => {
  const html = document.documentElement;
  html.dataset.theme = html.dataset.theme === "dark" ? "light" : "dark";
});

// === ATTENDANCE FORM ===
const students = [
  "Aarav Singh Mandhar","Shreya Ayyalasomayajula","Yvaine Wang","Junye Huang","Sanvi Byreddy",
  "Vinay Patel","Saanvika Nair","Ryan Thomas","Anay Chatterjee","Dhruv Bajaj","Sofia Shao",
  "Akshay Bhargav Varanasi","Edmund Bao","Pavel Chudnovskiy","Anvika Rath","Jayden Oh",
  "William Wang","Akhil Gollapally","Joann Antony","Nora Ahmed","Haasini Bharathwaj",
  "Anvi Dhome","Krishvee Anand","Rayansh Anand","Pavaki Rastogi","Samira Senthil","Ishani Bhat",
  "Zayna Rasheed","Ishaan Parthasarathy","Aarav Singhai"
];

const listContainer = document.getElementById("studentList");
students.forEach(name => {
  const div = document.createElement("div");
  div.className = "student";
  div.innerHTML = `<input type="checkbox" name="student" value="${name}" /> <label>${name}</label>`;
  listContainer.appendChild(div);
});

function markStatus(status) {
  document.querySelectorAll("input[name='student']:checked").forEach(cb => {
    cb.dataset.status = status;
    cb.nextElementSibling.style.color =
      status === "P" ? "green" : status === "A" ? "red" : "orange";
  });
}

document.getElementById("markPresent").addEventListener("click", () => markStatus("P"));
document.getElementById("markAbsent").addEventListener("click", () => markStatus("A"));
document.getElementById("markExcused").addEventListener("click", () => markStatus("E"));

document.getElementById("submitBtn").addEventListener("click", async () => {
  const date = document.getElementById("date").value;
  if (!date) return alert("Please select a date first.");

  const records = [];
  document.querySelectorAll("input[name='student']").forEach(cb => {
    if (cb.dataset.status) {
      records.push({ date, name: cb.value, status: cb.dataset.status });
    }
  });

  if (records.length === 0) return alert("No attendance marked!");

  try {
    await fetch(SCRIPT_URL, {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(records)
    });
    document.getElementById("successMsg").classList.add("show");
    setTimeout(() => document.getElementById("successMsg").classList.remove("show"), 2500);
    document.querySelectorAll("input[name='student']").forEach(cb => {
      cb.checked = false;
      cb.dataset.status = "";
      cb.nextElementSibling.style.color = "";
    });
  } catch (err) {
    alert("‚ùå Error: " + err.message);
  }
});
</script>

</body>
</html>
