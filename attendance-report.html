<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Attendance Report â€” BLMS Science Olympiad</title>

<style>
body {
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","Segoe UI",Roboto,Arial,sans-serif;
  background:linear-gradient(135deg,#eef2ff,#fefefe);
  color:#111;
  padding:40px;
}
h1{
  text-align:center;
  background:linear-gradient(90deg,#007aff,#9b7bff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:30px;
  box-shadow:0 6px 18px rgba(0,0,0,0.1);
}
th,td{
  padding:10px 14px;
  border-bottom:1px solid #ddd;
  text-align:left;
}
th{
  background:#007aff;
  color:white;
  position:sticky;
  top:0;
}
tr:hover{background:#f5f7ff;}
.status{font-weight:600;text-align:center;}
.status.P{color:#10b981;}
.status.A{color:#ef4444;}
.status.E{color:#f59e0b;}
.filter-bar{
  text-align:center;
  margin-top:20px;
}
.filter-bar input{
  padding:8px 12px;
  border-radius:8px;
  border:1px solid #ccc;
  width:220px;
}
button{
  margin-left:6px;
  padding:8px 16px;
  border:none;
  border-radius:8px;
  background:linear-gradient(90deg,#007aff,#9b7bff);
  color:white;
  font-weight:600;
  cursor:pointer;
}
.summary{
  margin-top:25px;
  text-align:center;
  font-weight:600;
  font-size:1.1rem;
}
</style>
</head>
<body>

<h1>Attendance Report</h1>

<div class="filter-bar">
  <input type="text" id="search" placeholder="Search name or date (YYYY-MM-DD)">
  <button onclick="loadData()">Refresh</button>
</div>

<div class="summary" id="summary"></div>

<table id="attendanceTable">
  <thead>
    <tr>
      <th>Timestamp</th>
      <th>Date</th>
      <th>Name</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwWH7UUFQ0IMom905bc47iPryybnGVinCsL_JFMu8zU6rDzjSoVQdOeGKn4vdOi3ZR7/exec";

async function loadData(){
  const res = await fetch(SCRIPT_URL);
  const data = await res.json();
  const search = document.getElementById("search").value.toLowerCase();
  const tbody = document.querySelector("#attendanceTable tbody");
  const summary = document.getElementById("summary");
  tbody.innerHTML = "";

  let counts = {P:0,A:0,E:0};

  data
    .filter(r => !search || 
      (r.name && r.name.toLowerCase().includes(search)) || 
      (r.date && r.date.includes(search)))
    .forEach(r => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${r.timestamp}</td>
        <td>${r.date}</td>
        <td>${r.name}</td>
        <td class="status ${r.status}">${r.status}</td>
      `;
      tbody.appendChild(tr);
      if(counts[r.status] !== undefined) counts[r.status]++;
    });

  summary.textContent = 
    `Present: ${counts.P} | Absent: ${counts.A} | Excused: ${counts.E}`;
}

loadData();
</script>
</body>
</html>


